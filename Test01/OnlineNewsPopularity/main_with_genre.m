% ========== Clear All ==========clear ; close all; clc% ========== Read Data ==========rawData = csvread('OnlineNewsPopularityGenre.csv');% ========== Data Size ==========m = size(rawData, 1);n = size(rawData, 2);% ========== Divide Data ==========trainData = rawData(2:31717, 2:n - 1);validationData = rawData(31718:35681, 2:n - 1);testData = rawData(35682:m, 2:n - 1);% ========== Add Feature 0 ==========%trainData = [ones(31716, 1) trainData];%validationData = [ones(3964, 1) validationData];%testData = [ones(3964, 1) testData];% ========== Divide Y ==========trainY = rawData(2:31717, n);validationY = rawData(31718:35681, n);testY = rawData(35682:m , n);% ========== Read Summary ==========summaryStat = csvread('SummaryStatisticsGenre.csv');useStat = summaryStat(2:size(summaryStat, 1), 2:size(summaryStat, 2));% ========== Feature Scaling ==========X_norm = (trainData - useStat(:,3)') ./ useStat(:,4)';X_norm = [ones(31716, 1), X_norm];%theta = ones(size(useStat, 1) + 1, 1);alpha1 = 0.3;alpha2 = 0.1;alpha3 = 0.03;alpha4 = 0.01;alpha5 = 0.003;alpha6 = 0.001;num_iters = 100;%alpha = [3.0e-12; 1.0e-12; 3.0e-13; 1.0e-13; 3.0e-14; 1.0e-14]%trainTheta = zeros(59, 6);%J_history = zeros(100, 6);[theta1, J_history1] = gradientDescentMulti(X_norm, trainY, theta, alpha1, num_iters);[theta2, J_history2] = gradientDescentMulti(X_norm, trainY, theta, alpha2, num_iters);[theta3, J_history3] = gradientDescentMulti(X_norm, trainY, theta, alpha3, num_iters);[theta4, J_history4] = gradientDescentMulti(X_norm, trainY, theta, alpha4, num_iters);[theta5, J_history5] = gradientDescentMulti(X_norm, trainY, theta, alpha5, num_iters);[theta6, J_history6] = gradientDescentMulti(X_norm, trainY, theta, alpha6, num_iters);figure;plot(1:100, J_history1(1:100), '-b', 'LineWidth', 2);hold on;plot(1:100, J_history2(1:100), '-m', 'LineWidth', 2);plot(1:100, J_history3(1:100), '-r', 'LineWidth', 2);plot(1:100, J_history4(1:100), '-k', 'LineWidth', 2);plot(1:100, J_history5(1:100), '-y', 'LineWidth', 2);plot(1:100, J_history6(1:100), '-g', 'LineWidth', 2);%%validate_X_norm = (validationData - useStat(:,3)') ./ useStat(:,4)' ;%validate_X_norm = [ones(3964, 1), validate_X_norm];%%res = [mean(abs(validate_X_norm*theta1 - validationY));%mean(abs(validate_X_norm*theta2 - validationY));%mean(abs(validate_X_norm*theta3 - validationY));%mean(abs(validate_X_norm*theta4 - validationY));%mean(abs(validate_X_norm*theta5 - validationY));%mean(abs(validate_X_norm*theta6 - validationY))]%test_X_norm = (testData - useStat(:,3)') ./ useStat(:,4)';test_X_norm = [ones(3964, 1), test_X_norm];res = [mean(abs(test_X_norm*theta1 - testY));mean(abs(test_X_norm*theta2 - testY));mean(abs(test_X_norm*theta3 - testY));mean(abs(test_X_norm*theta4 - testY));mean(abs(test_X_norm*theta5 - testY));mean(abs(test_X_norm*theta6 - testY))]